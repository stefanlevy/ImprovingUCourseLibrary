# Mutable

```JavaScript
new jko.Mutable(type, entity, defaultValue, user, resource);
```

* `type` : string - The type of the fact representing each value of the property.
* `entity` : fact - The fact that has this mutable property.
* `defaultValue` : string, number, or object - The value returned for this property before any facts are recorded.
* `user` : fact *(optional)* - The logged in user's fact, representing who changed this property.
* `resource` : fact *(optional)* - The secured fact that controls access for this property.

Returns

```JavaScript
{
  value,
  inConflict,
  candidates,
  watch
}
```

* `value` : ko.computed - Bindable sub-property for the current value of this property.
* `inConflict` : function() returning bool - Returns true if a conflict in this property has been detected.
* `candidates` : function() returning array - Returns the possible values in the case of a conflict, or the single value if not in conflict.
* `watch` : function(fact or watch) returning a watch - Starts a watch from the specified fact or watch to find values of this property.

## How it works

Under the covers, Mutable defines a fact that captures the value of the property as it changes over
time. The fact looks like this:

```JavaScript
j.fact({
  type: type,
  entity: entity,
  value: 'Current Value',
  prior: [priorValueFacts],
  from: user,    // If provided
  in: resource   // If provided
});
```

The Mutable class also defines a template function matching the current values of the property. The
template function looks like this:

```JavaScript
function mutablesInEntity(e) {
  return j.where({
    type: type,
    entity: e
  }, [isCurrent]);
}

function isCurrent(p) {
  return j.not({
    type: type,
    prior: p
  });
}
```

You don't have to write this code yourself. It's generated by the Mutable class. But you do have to start
the watch. You can start it from the top level by passing in an entity fact:

```JavaScript
this.name.watch(userGroup);
```

Or you can start it from a child level by passing in a parent watch:

```JavaScript
this.topic.watch(meetingWatch);
```
